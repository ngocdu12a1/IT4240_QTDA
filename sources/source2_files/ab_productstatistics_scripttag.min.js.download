(function(n,t,i,r){var f,e,o=!1,u;if(!(f=n.jQuery)||i>f.fn.jquery||r(f,o)){u=t.createElement("script");u.type="text/javascript";u.src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js";u.onload=u.onreadystatechange=function(){o||(e=this.readyState)&&e!=="loaded"&&e!=="complete"||(r((f=n.jQuery).noConflict(1),o=!0),f(u).remove())};try{t.body.appendChild(u)}catch(s){try{t.documentElement.childNodes[0].appendChild(u)}catch(s){}}}})(window,document,"1.9.1",function(n){"use strict";function v(n,t){var i,r,u;r=!1;i=document.createElement("script");i.type="text/javascript";i.src=n;i.onload=i.onreadystatechange=function(){r||this.readyState&&this.readyState!=="complete"||(r=!0,t&&typeof t=="function"&&t())};u=document.getElementsByTagName("script")[0];u.parentNode.insertBefore(i,u)}function y(n){var t=function(){var t=document.createElement("link"),i;t.rel="stylesheet";t.href=n;i=document.getElementsByTagName("head")[0];i.appendChild(t)},i=requestAnimationFrame||mozRequestAnimationFrame||webkitRequestAnimationFrame||msRequestAnimationFrame;i?i(t):window.addEventListener("load",t)}var t="";switch("prod"){case"prod":t="https://productstatistics.sapoapps.vn";break;case"dev":t="https://improvement.sapoapps.vn"}var s=function(){var t="",n=window.Bizweb.store;return typeof n!="undefined"&&n.indexOf(".bizwebvietnam.net")>-1&&(t=n.replace(".bizwebvietnam.net","")),t},f=4e4,h=t+"/Storefront/GetMultiStats",c=t+"/Storefront/GetStats",l=t+"/Storefront/UpdateViews",a=t+"/Storefront",e='<div class="ab-clearfix"><\/div>',r={},i={},u=s();window.ABProdStats=window.ABProdStats||{};String.prototype.format||(String.prototype.format=function(){var n=arguments;return this.replace(/{(\d+)}/g,function(t,i){return typeof n[i]!="undefined"?n[i]:t})});Node.prototype.getElementsByAttributeValue||(Node.prototype.getElementsByAttributeValue=function(n,t){var i=this.all||this.getElementsByTagName("*"),u=[];for(var r in i)typeof i[r]=="object"&&i[r].getAttribute(n)===t&&u.push(i[r]);return u});Object.size||(Object.size=function(n){var t=0;for(var i in n)n.hasOwnProperty(i)&&t++;return t});window.ABProdStats.money_format||n.ajax({dataType:"json",url:"https://"+window.Bizweb.store+"/meta.js",type:"GET",async:!1,success:function(n){window.ABProdStats.money_format=n.money_format}});var p=function(){var n=document.getElementsByClassName("abps-products"),t=[],i,u,r;if(!n.length||n.length<=0)return t;for(i=0;i<n.length;i++)u=n[i].getAttribute("ab-data-productid"),r=parseInt(u,10),r&&t.indexOf(r)<0&&t.push(r);return t},w=function(){var n=document.getElementsByClassName("abps-productdetail"),i,t;return!n.length||n.length<=0?0:(i=n[0].getAttribute("ab-data-productid"),t=parseInt(i,10),!t)?0:t},b=function(){var t=p(),i=w();t.length&&t.length>0&&k(t);i>0&&n.ajax({url:l,data:{storeAlias:u,productId:i},type:"POST",timeout:f,success:function(){console.log("Update done");d(i)},error:function(){console.log("Có lỗi xảy ra!")}})},k=function(t){n.ajax({url:h,data:{storeAlias:u,productIds:t},type:"POST",timeout:f,traditional:!0,success:function(n){n.Status=="success"?(r=n.Data,g()):console.log("Có lỗi xảy ra!")},error:function(){console.log("Có lỗi xảy ra!")}})},d=function(t){n.ajax({url:c,data:{storeAlias:u,productId:t},type:"GET",timeout:f,success:function(n){n.Status=="success"?(i=n.Data,nt()):console.log("Có lỗi xảy ra!")},error:function(){console.log("Có lỗi xảy ra!")}})},g=function(){var o="<div class='abps-purchases-block' title='Lượt mua'><i class='abps-purchases-icon'><\/i><span>{0}<\/span><\/div><div class='abps-views-block' title='Lượt xem'><i class='abps-views-icon'><\/i><span>{1}<\/span><\/div>",h=o.format(0,0),s,i,u,f,t;if(r.length){for(t=0;t<r.length;t++)if(s=o.format(r[t].AllPurchases,r[t].Views),i=n(".abps-products[ab-data-productid="+r[t].Id+"]"),i.length)for(u=0;u<i.length;u++)i[u].innerHTML=s,n(i[u]).removeClass("ab-hide").before(e);if(f=n(".abps-products.ab-hide"),f.length)for(t=0;t<f.length;t++)f[t].innerHTML=h,n(f[t]).removeClass("ab-hide").before(e)}},nt=function(){var t=n(".abps-productdetail[ab-data-productid="+i.Id+"]"),c=i.Views,o=i.AllPurchases,r,s,f,h,u;if(t.length)for(r=n(t).parents("form").find("[name=variantId]"),r.length||(r=n(t).parents("form").find("[name=VariantId]")),r.length&&(s=r[0].value?parseInt(r[0].value,10):0,f=n.grep(i.Variants,function(n){return n.Id==s}),f.length&&(o=f[0].Purchases)),h="<div class='abps-purchases-block' title='Lượt mua'><i class='abps-purchases-icon'><\/i><span>Có <strong>{0}<\/strong> lượt mua sản phẩm<\/span><\/div><div class='abps-views-block' title='Lượt xem'><i class='abps-views-icon'><\/i><span>Có <strong>{1}<\/strong> lượt xem sản phẩm<\/span><\/div>".format(o,c),u=0;u<t.length;u++)t[u].innerHTML=h,n(t[u]).removeClass("ab-hide").before(e)},tt=function(){var r=n(".abps-productdetail[ab-data-productid="+i.Id+"]"),e=i.AllPurchases,t,o,f,u;if(r.length)for(t=n(r).parents("form").find("[name=variantId]"),t.length||(t=n(r).parents("form").find("[name=VariantId]")),t.length&&(o=t[0].value?parseInt(t[0].value,10):0,f=n.grep(i.Variants,function(n){return n.Id==o}),f.length&&(e=f[0].Purchases)),u=0;u<r.length;u++)n(r[u]).find(".abps-purchases-block strong").text(e)},it=function(){if(u!==""){var i=document.getElementsByClassName("ab-most-view-product-module");!i.length||i.length<=0||n.ajax({url:a,data:{storeAlias:u},type:"GET",timeout:f,traditional:!0,success:function(n){window.Swiper&&typeof Swiper=="function"?o(n):(y(t+"/scripts/swiper/swiper.min.css"),v(t+"/scripts/swiper/swiper.min.js",function(){o(n)}))},error:function(){console.log("Có lỗi xảy ra!")}})}},o=function(t){var f=n(".ab-most-view-product-module"),r,e,o,i;f.html(t);var u=parseInt(f.find(".most-view-slides-per-view").val(),10),h=f.find(".most-view-product-element").length,s={320:{slidesPerView:1,spaceBetween:10}};if(h<u&&(u=h),u>2&&(s["600"]={slidesPerView:2,spaceBetween:20}),u>3&&(s["800"]={slidesPerView:3,spaceBetween:30}),f.find(".money").each(function(){var t=n(this);t.html(Bizweb.formatMoney(parseFloat(t.attr("data-price")),window.ABProdStats.money_format))}),r={},e=n(".most-view-module-body.swiper-container"),e.length&&e.length>0&&e.each(function(t){var i=n(this),f=i.parents(".ab-most-view-product-module");i.addClass("instance-"+t);f.find(".most-view-btn-pager-next").addClass("most-view-btn-next-"+t);f.find(".most-view-btn-pager-prev").addClass("most-view-btn-prev-"+t);r[t]=new Swiper(".most-view-module-body.swiper-container.instance-"+t,{slidesPerView:u,nextButton:".most-view-btn-next-"+t,prevButton:".most-view-btn-prev-"+t,loop:!0,spaceBetween:30,breakpoints:s})}),o=Object.size(r),o&&o>0)for(i=0;i<o;i++)n(".most-view-module-body.swiper-container.instance-"+i).parents(".ab-most-view-product-module").removeClass("ab-hide"),r[i].update(!0),r[i].width<=340&&(r[i].params.slidesPerView=1,r[i].params.breakpoints={},r[i].update(!0))};window.ABProdStats.abChangeProductStats=tt;n(document).ready(function(){b();it()})});